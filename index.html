<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Day habits</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <link rel="manifest" href="/routine/manifest.json">
  <link rel="apple-touch-icon" href="/routine/icons/icon-192.png">
  <style>
    /* Iridescent background */
    body {
      margin: 0;
      font-family: 'Inter', system-ui, sans-serif;
      height: 100vh;
      background: linear-gradient(115deg, 
          rgba(255, 255, 255, 0.8), 
          rgba(255, 245, 250, 0.8), 
          rgba(245, 255, 255, 0.8), 
          rgba(255, 255, 240, 0.8));
      background-size: 400% 400%;
      animation: iridescentBackground 20s ease infinite;¬µ
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
    }

    @keyframes iridescent {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    h1 {
      font-size: 2.5em;
      margin: 1em 0 0.5em;
      font-weight: 700;
      color: #333;
      text-align: center;
    }
    .alert{
      position: fixed;
      top:0; 
      left:0; 
      width:100vw;
      font-size: 1em;
      text-align: center;
      background-color: rgb(223, 146, 154);
      color: rgb(158, 39, 42);
      border-bottom: solid 2px rgb(158, 39, 42);
    }
    .columns{
      display: flex;
      justify-content: center;
      gap: 0rem; /* optional spacing */
    }

    .note-container {
      width: 50%;
      height: calc(80vh - 5em);
      background: #fbf9fa;
      border-radius: 0 20px 20px 0;
      overflow-y: auto;
      padding: 1em;
      margin:0 45px 0 0;
      overflow: auto;          /* Enables scrolling */
      scrollbar-width: none;   /* Firefox: hides scrollbar */
      -ms-overflow-style: none;/* IE 10+ */
      justify-content: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .idea-container {
      position: relative;
      display: flex;
      flex-wrap: wrap;          /* Enables grid-like wrapping */
      justify-content: center;  /* Centers the grid horizontally */
      align-items: flex-start;  /* Aligns rows to the top */
      gap: 1em;                 /* Space between items */
      
      /* Existing styles */
      width: 50%;
      height: calc(80vh - 5em);
      background: rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      
      padding: 1em;
      margin: 0 15px;
      
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .scoreContainer {
      text-align: center;
      position: absolute;
      bottom: 0px;
      font-size: 5em;
      min-width: 100%;
      color:#333;
    }

    .scoreContainer::before {
      content: 'Day score';
      position: absolute;   /* Needed to apply top/left */
      left: 50%;  
      top:-25px;   
      transform: skewX(-15deg) translate(-50%, 0);
      font-size: 0.3em;
      background-color:#ccc;
      color: #fefefe;          /* Optional: differentiate it visually */
    }
    .main-container {
      width: 100%;
      height: calc(80vh - 5em);
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      overflow-y: auto;
      padding: 1em;
      margin:0px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      overflow: auto;          /* Enables scrolling */
      scrollbar-width: none;   /* Firefox: hides scrollbar */
      -ms-overflow-style: none;/* IE 10+ */
    }

    .container::-webkit-scrollbar {
      display: none;           /* Chrome, Safari and Edge */
    }

    .time-block {
      display: flex;
      align-items: center;
      margin-bottom: 0.5em;
      border-radius: 10px;
    }

    .time-block.current {
/*      border: 2px solid #fff;*/
/*      box-shadow: 0 0 15px 4px rgba(255, 255, 255, 0.8);*/
      background-color: rgba(170, 255, 113, 0.3);
    }

    .time-block.current::before{
      content: "‚ñ∂";
      color: #333;
      text-align: right;
      width:10px;
      margin-left:-5px;
      margin-right:-5px;
      z-index: 2;
    }

    .time-label {
      width: 80px;
      padding: 0.4em;
      border-radius: 10px;
      color: white;
      font-weight: bold;
      text-align: center;
      margin-right: 1em;
      flex-shrink: 0;
    }

    .description {
      flex: 1;
      background: rgba(255, 255, 255, 0.3);
      border: none;
      border-radius: 10px;
      padding: 0.5em;
      color: #333;
      font-size: 1.2em;
    }

    .description:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.6);
    }

    .description:empty:before {
      content: attr(data-placeholder);
      color: #999;
      pointer-events: none;
    }

    .idea {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      
      width: 150px;      /* Fixed square size */
      height: 150px;     /* Fixed square size */
      box-sizing: border-box;
      padding: 10px;
      margin:10px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .idea:hover{
      transform:scale(1.2);
    }

    .idea h2 {
      margin: 0 0 0px 0;
      text-align: center;
      font-size: 1.2rem;
    }

    .idea p {
      flex-grow: 1;               /* Take maximal remaining vertical space */
      font-size: 4rem;            /* Big emoji size */
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;          /* Optional: prevent emoji text selection */
    }

    .notepad{
      width:calc(100% - 20px);
      height:calc(100% - 7em);
      background-color: #fff7bb;
      border-radius:5px;
      padding:10px;
    }

@media (max-width: 768px) {
  .no-mobile {
    display: none !important;
  }

  .main-container {
      width: 100%;
      height: calc(90vh - 5em);
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 0px;
      overflow-y: auto;
      padding: 1em;
      margin:0px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0);
      overflow: auto;          /* Enables scrolling */
      scrollbar-width: none;   /* Firefox: hides scrollbar */
      -ms-overflow-style: none;/* IE 10+ */
    }
}

    
  </style>
</head>
<body>
  <div id='alert' class ="alert no-mobile"  onclick="localStorage.clear();window.location.reload();">   </div>
  <h1 id='title'>Petite Routine</h1>

  <div class="columns" id="columnsContainer">  
    <div class="container note-container no-mobile" id="notesContainer">
        <h2> Notes de la journ√©e </h2>
        <div class="notepad" contenteditable='true' spellcheck='false' data-status-field-id = 'notes'> 
        </div>

    </div>

    <div class="container main-container" id="timeContainer"></div>

    <div class="container idea-container no-mobile" id="ideaContainer">
      <div class='idea' 
           data-status-field-id='i1' 
           data-status-done='' 
           data-status-time='' 
           data-status-day='Lundi/Jeudi' 
           data-status-score='15' 
           onclick="clickIdea(this);">
        <h2> Remercier un ami </h2>
        <p> üíñ </p>
      </div>

      <div class='idea' 
           data-status-field-id='i2' 
           data-status-done='' 
           data-status-time='' 
           data-status-day='Mercredi' 
           data-status-score='30' 
           onclick="clickIdea(this);">
        <h2> Wednesday Coffee </h2>
        <p> üçµ </p>
      </div>

      <div class='idea' 
           data-status-field-id='i2' 
           data-status-done='' 
           data-status-time='8:30/10:00/12:30/14:00/16:00/18:00' 
           data-status-day='Lundi/Mardi/Mercredi/Jeudi/Vendredi/Samedi/Dimanche' 
           data-status-score='10' 
           onclick="clickIdea(this);">
        <h2> Boire de l'eau </h2>
        <p> üíß </p>
      </div>

      <div class='idea' 
           data-status-field-id='' 
           data-status-done='' 
           data-status-time='8:30/10:00/12:30/14:00/16:00/18:00' 
           data-status-day='Lundi/Mardi/Mercredi/Jeudi/Vendredi/Samedi/Dimanche' 
           data-status-score='10' 
           onclick="clickIdea(this);">
        <h2> S'√©tirer </h2>
        <p> ü§∏ </p>
      </div>

      <div class='idea' 
           data-status-field-id='' 
           data-status-done='' 
           data-status-time='10:00/14:00/16:00' 
           data-status-day='Lundi/Mardi/Mercredi/Jeudi/Vendredi/Samedi/Dimanche' 
           data-status-score='10' 
           onclick="clickIdea(this);">
        <h2> Faire une pause </h2>
        <p> ‚è∏Ô∏è </p>
      </div>

      <div class='idea' 
           data-status-field-id='' 
           data-status-done='' 
           data-status-time='8:30/10:00/12:30/14:00/16:00/18:00' 
           data-status-day='Lundi/Mardi/Mercredi/Jeudi/Vendredi/Samedi/Dimanche' 
           data-status-score='10' 
           onclick="clickIdea(this);">
        <h2> Faire un tour dehors </h2>
        <p> üèûÔ∏è </p>
      </div>


      <div class="scoreContainer" id = 'dayScore' data-status-field-id = 'dayscore'> 0 </div>
    </div>
    

  </div>
<script>
  const container = document.getElementById('timeContainer');
  const colors = getTimeMappedColors();

  const now = new Date();
  const currentHour = now.getHours();
  const currentMinute = now.getMinutes();
  const nearestHalfHour = currentMinute >= 30 ? 30 : 0;
  let currentTimeString = `${currentHour.toString().padStart(2, '0')}:${nearestHalfHour.toString().padStart(2, '0')}`;
  const weekdayIndex = now.getDay(); // Sunday = 0, Monday = 1, ..., Saturday = 6

  const weekdays = ["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"];
  const currentWeekday = weekdays[weekdayIndex];

  document.getElementById('title').textContent = currentWeekday;

  var dayScore = 0;;
  localAlert("Warning: This content is public. \n This page uses local storage only. You can refresh it but not save it or get its content on other devices.");

  let currentBlock = null;
  const habits = {
  '00:00': 'üåô ZzZzz',
  '00:30': 'üåô ZzZzz',
  '01:00': 'üåô ZzZzz',
  '01:30': 'üåô ZzZzz',
  '02:00': 'üåô ZzZzz',
  '02:30': 'üåô ZzZzz',
  '03:00': 'üåô ZzZzz',
  '03:30': 'üåô ZzZzz',
  '04:00': 'üåô ZzZzz',
  '04:30': 'üåô ZzZzz',
  '05:00': 'üåô ZzZzz',
  '05:30': 'üåô ZzZzz',
  '06:00': 'üåô ZzZzz',
  '06:30': 'üåô ZzZzz',
  '07:00': 'üåÖ R√©veil, toilette, douche',
  '07:30': 'ü´ß Rangement de la chambre, commu, etc.',
  '08:00': 'üßá Petit d√©jeuner et d√©part',
  '08:30': 'üñ•Ô∏è Gestions des mails et timesheets',
  '09:00': 'üñ•Ô∏è R√©ponses aux mails',
  '09:30': 'üñ®Ô∏è Impression du jour et services',
  '10:00': 'üñ®Ô∏è Impression du jour et services',
  '10:30': 'üñ•Ô∏è Administratif: AO, notes de frais, etc.',
  '11:00': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '11:30': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '12:00': '‚òÄÔ∏è Pause de midi',
  '12:30': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '13:00': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '13:30': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '14:00': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '14:30': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '15:00': 'üí≠ T√¢ches sp√©cifiques (MS Todo)',
  '15:30': 'üí≠ T√¢ches sp√©cifiques (MS Todo)', 
  '16:00': 'üñ•Ô∏è Gestion des mails et timesheets',
  '16:30': 'üñ•Ô∏è Gestion des mails et timesheets',
  '17:00': 'üñ•Ô∏è Planification des jours suivants',
  '17:30': 'üéà Temps personnel',
  '18:00': 'üéà Temps personnel',
  '18:30': 'üè° Retour √† la maison',
  '19:00': 'üçΩÔ∏è Cuisiner et souper',
  '19:30': 'üçΩÔ∏è Cuisiner et souper',
  '20:00': 'ü™™ Administratif personnel',
  '20:30': 'üéà Temps personnel',
  '21:00': 'üéà Temps personnel',
  '21:30': 'üéà Temps personnel',
  '22:00': 'üõå Au dodo',
  '22:30': 'üåô ZzZzz',
  '23:00': 'üåô ZzZzz',
  '23:30': 'üåô ZzZzz'
};

 function renderTimeBlocks() {
  container.innerHTML = ''; // Clear previous blocks
  const now = new Date();
  currentTimeString_tmp = `${now.getHours().toString().padStart(2, '0')}:${(now.getMinutes() < 30 ? 0 : 30).toString().padStart(2, '0')}`;
  if(currentTimeString_tmp !== currentTimeString){
    undoHourlyIdeas();
  }
  currentTimeString = currentTimeString_tmp;
  const ideas = document.querySelectorAll('.idea');
  ideas.forEach(idea => {
    if(idea.dataset.statusDay.includes(currentWeekday) && !idea.dataset.statusDone.includes('done') ){
      let statusTime = idea.dataset.statusTime || "";
      if (
        statusTime.split('/').includes(currentTimeString) || 
        statusTime === ""
      ) {
        idea.style.display = "flex";
      } else {
        idea.style.display = "none";
      }
} else {
        idea.style.display = "none";
      }
  });

  let currentBlock = null;

  for (let h = 0; h < 24; h++) {
    for (let m = 0; m <= 30; m += 30) {
      const timeStr = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
      const block = document.createElement('div');
      block.className = 'time-block';

      const label = document.createElement('div');
      label.className = 'time-label';
      const index = Math.floor((h * 60 + m) / 60 * colors.length / 24);
      label.style.backgroundColor = colors[index];
      label.textContent = timeStr;

      const desc = document.createElement('div');
      desc.className = 'description';
      // desc.contentEditable = true;
      desc.spellCheck = false;
      desc.setAttribute('data-placeholder', 'Choose a task for today');
      // desc.setAttribute('data-status-field-id', timeStr);
      desc.innerText = habits[timeStr] || '';

      block.appendChild(label);
      block.appendChild(desc);
      container.appendChild(block);

      if (timeStr === currentTimeString) {
        currentBlock = block;
        block.classList.add('current');
      }
    }
  }

  if (currentBlock) {
    setTimeout(() => {
      currentBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
      dayScore = parseInt(document.getElementById('dayScore').textContent)
    }, 100);
  }
}

// Initial render
renderTimeBlocks();

function checkIdeaOverflow() {
  const parent = document.getElementById('ideaContainer');
  const ideas = document.querySelectorAll('.idea'); // Get all .idea elements

  if (!parent || ideas.length === 0) return;

  const parentRect = parent.getBoundingClientRect();

  ideas.forEach(idea => {
    const ideaRect = idea.getBoundingClientRect();

    // Optional: mark visible elements (for debug)

    const isOverflowing =
      ideaRect.bottom > parentRect.bottom - 100 ||
      ideaRect.top < parentRect.top ||
      ideaRect.left < parentRect.left ||
      ideaRect.right > parentRect.right;

    idea.style.opacity = isOverflowing ? 0 : 1;
  });
}

// Run when the page loads, and on scroll/resize
window.addEventListener('DOMContentLoaded', checkIdeaOverflow);
window.addEventListener('resize', checkIdeaOverflow);
window.addEventListener('scroll', checkIdeaOverflow, true);


// local data restore 
window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem('snapshot');
    if (!saved) return;

    const data = JSON.parse(saved);

    for (const [id, content] of Object.entries(data)) {
        const el = document.querySelector(`[data-status-field-id="${id}"]`);
        if (el) el.innerText = content;
    }
});

// Update every minute
setInterval(renderTimeBlocks, 60000);

function getTimeMappedColors() {
  const colors = [
  // Midnight to dawn (dark blues)
  '#011b3e', '#011b3e', '#022245', '#00264b', '#00264b', '#002c4f',
  '#002c4f', '#003152', '#003f5e', '#00405e', '#064f72', '#0b7895',

  // Sunrise to morning (blues to cyan)
  '#0b7895', '#45adba', '#45adba', '#aae0c8', '#aae0c8', '#aae0c8',

  // Midday zone (light blues and yellows ‚Äî elongated)
  '#cfdf8e', '#cfdf8e', '#f2d770', '#f3d672', '#fec76c', '#fec76c',
  '#fec460', '#fec460', '#fcc05e', '#fdc05e', '#f7ab57', '#f7ab57',
  '#f48969', '#f4896a',

  // Afternoon to evening (warm to cool down)
  '#dd717e', '#df717d', '#954687', '#954687', '#542680', '#53277e',

  // Nightfall to night (deep blues and purples)
  '#361b71', '#351b72', '#292369', '#262468', '#131d58', '#0b1b51',
  '#02184a', '#011b3e', '#011b3e', '#000000', 
];


  return colors;
}


function clickIdea(idea){
  idea.setAttribute('data-status-done', 'done');
  idea.style.display = 'none';
  let actionScore =   parseInt(idea.dataset.statusScore);
  dayScoreAdd(actionScore);
}

function undoHourlyIdeas(){
    const ideas = document.querySelectorAll('.idea');
    ideas.forEach(idea => {
      if(idea.dataset.statusDay.includes(currentWeekday)){
        let statusTime = idea.dataset.statusTime || "";
        if (
          statusTime.split('/').includes(currentTimeString)
        ) {
          idea.setAttribute('data-status-done', '');
        }
      }
    });
}

function dayScoreAdd(n){
  //refresh dayscore
  dayScore += n;
  document.getElementById("dayScore").textContent = dayScore;
}

function snapshot() {
    const data = {};

    document.querySelectorAll('[data-status-field-id]').forEach(el => {
        const id = el.getAttribute('data-status-field-id');
        data[id] = el.innerText.trim();
    });

    // Store in localStorage
    localStorage.setItem('snapshot', JSON.stringify(data));
}

// Run every 10s
setInterval(snapshot, 1000);

function localAlert(text){
  document.getElementById('alert').style.display= 'block';
  document.getElementById('alert').textContent = text;
  setTimeout(() => {
      document.getElementById('alert').style.display= 'none';
    }, 5000);
}
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 's') {
        e.preventDefault();
        localAlert("Saving the page is disabled.");

    }
});


// test
</script>

</body>
</html>

<!--

  file:///C:/Users/avangeersdae/OneDrive%20-%20UCL/UCL/5)%20Projets%20personnels/Day%20habits/index.html 

-->

